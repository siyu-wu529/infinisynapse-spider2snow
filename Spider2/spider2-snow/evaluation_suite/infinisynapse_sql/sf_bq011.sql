WITH seven_day_users AS (
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM "EVENTS_20210101"
  WHERE PARSE_JSON("EVENT_PARAMS"):engagement_time_msec.int_value > 0
  UNION
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM "EVENTS_20210102"
  WHERE PARSE_JSON("EVENT_PARAMS"):engagement_time_msec.int_value > 0
  UNION
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM "EVENTS_20210103"
  WHERE PARSE_JSON("EVENT_PARAMS"):engagement_time_msec.int_value > 0
  UNION
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM "EVENTS_20210104"
  WHERE PARSE_JSON("EVENT_PARAMS"):engagement_time_msec.int_value > 0
  UNION
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM "EVENTS_20210105"
  WHERE PARSE_JSON("EVENT_PARAMS"):engagement_time_msec.int_value > 0
  UNION
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM "EVENTS_20210106"
  WHERE PARSE_JSON("EVENT_PARAMS"):engagement_time_msec.int_value > 0
  UNION
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM "EVENTS_20210107"
  WHERE PARSE_JSON("EVENT_PARAMS"):engagement_time_msec.int_value > 0
),
two_day_users AS (
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM "EVENTS_20210106"
  WHERE PARSE_JSON("EVENT_PARAMS"):engagement_time_msec.int_value > 0
  UNION
  SELECT DISTINCT "USER_PSEUDO_ID"
  FROM "EVENTS_20210107"
  WHERE PARSE_JSON("EVENT_PARAMS"):engagement_time_msec.int_value > 0
)
SELECT COUNT(*) AS "user_count"
FROM seven_day_users s
LEFT JOIN two_day_users t ON s."USER_PSEUDO_ID" = t."USER_PSEUDO_ID"
WHERE t."USER_PSEUDO_ID" IS NULL;